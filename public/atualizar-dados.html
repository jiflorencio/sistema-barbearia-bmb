<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atualizar Dados - Barbearia BMB</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .box {
            background: rgba(255, 255, 255, 0.1);
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2);
        }

        .box::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: shine 4s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .box h2 {
            margin-bottom: 20px;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4em;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }

        /* Status Cards */
        .status-card {
            background: linear-gradient(45deg, #28a745, #20c997);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .status-card.warning {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
        }

        .status-card.info {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-item {
            background: rgba(255, 255, 255, 0.15);
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .status-item .label {
            font-size: 0.8em;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .status-item .value {
            font-size: 1.1em;
            font-weight: bold;
        }

        /* Alerts */
        .alert {
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
        }

        .alert.warning {
            background: linear-gradient(45deg, #ff6b35, #f7931e);
            animation: pulse 2s infinite;
        }

        .alert.info {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .alert.success {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* Buttons */
        .btn {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9em;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.4);
        }

        .btn.secondary {
            background: linear-gradient(45deg, #6c757d, #495057);
            color: white;
        }

        .btn.danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }

        .btn.success {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        /* Forms */
        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #ffd700;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 0.9em;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* Upload Areas */
        .upload-area {
            border: 2px dashed #ffd700;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            background: rgba(255, 215, 0, 0.05);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: #ffed4e;
        }

        .upload-area.dragover {
            background: rgba(255, 215, 0, 0.2);
            transform: scale(1.02);
        }

        /* Charts */
        .mini-chart {
            height: 100px;
            display: flex;
            align-items: end;
            gap: 5px;
            padding: 10px 0;
            margin: 10px 0;
        }

        .chart-bar {
            flex: 1;
            background: linear-gradient(to top, #ffd700, #ffed4e);
            border-radius: 2px 2px 0 0;
            position: relative;
            transition: all 0.3s ease;
            min-height: 10px;
        }

        .chart-bar:hover {
            filter: brightness(1.2);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            margin: 3% auto;
            padding: 30px;
            border-radius: 15px;
            width: 95%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #ffd700;
        }

        /* Preview Areas */
        .preview-area {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            display: none;
        }

        .preview-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .preview-stat {
            text-align: center;
            padding: 8px;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 6px;
            font-size: 0.8em;
        }

        /* Quick Stats */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .quick-stat {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #ffd700;
        }

        .quick-stat .number {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd700;
        }

        .quick-stat .label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .status-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .quick-stats {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .bounce {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-8px); }
            60% { transform: translateY(-4px); }
        }

        /* Additional Styles */
        .success-message {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
        }

        .progress-bar {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            height: 20px;
            margin: 10px 0;
        }

        .progress-fill {
            background: linear-gradient(45deg, #ffd700, #ffed4e);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header fade-in">
            <h1>🏆 Sistema de Gestão BMB</h1>
            <p>Atualização e Controle de Dados Completo</p>
            <div class="quick-stats">
                <div class="quick-stat">
                    <div class="number" id="totalCadastros">1.247</div>
                    <div class="label">Total Cadastros</div>
                </div>
                <div class="quick-stat">
                    <div class="number" id="totalMovimentos">2.856</div>
                    <div class="label">Movimentos</div>
                </div>
                <div class="quick-stat">
                    <div class="number" id="cadastrosHoje">12</div>
                    <div class="label">Hoje</div>
                </div>
            </div>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            
            <!-- 1. IMPORTAR CADASTRO -->
            <div class="box fade-in">
                <h2>📁 Importar Cadastro</h2>
                
                <!-- Status do Cadastro -->
                <div class="status-card">
                    <h4>📊 Status do Cadastro Principal</h4>
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="label">📅 Última Importação</div>
                            <div class="value" id="lastCadastroDate">10/08/2025</div>
                        </div>
                        <div class="status-item">
                            <div class="label">📊 Total Registros</div>
                            <div class="value" id="totalRegistros">1.247</div>
                        </div>
                        <div class="status-item">
                            <div class="label">⏱️ Há quanto tempo</div>
                            <div class="value" id="cadastroTimeSince">5 dias</div>
                        </div>
                    </div>
                    
                    <div class="alert warning">
                        <span>⚠️</span>
                        <span>Base de cadastro desatualizada! Importe novos dados.</span>
                    </div>
                </div>

                <!-- Upload de Cadastro -->
                <div class="upload-area" id="cadastroUpload" onclick="document.getElementById('fileCadastro').click()">
                    <div style="font-size: 2em; margin-bottom: 10px;">📁</div>
                    <div><strong>Clique ou arraste o arquivo de cadastro</strong></div>
                    <div style="font-size: 0.8em; opacity: 0.7;">Formatos: .xlsx, .xls, .csv</div>
                </div>
                <input type="file" id="fileCadastro" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleCadastroFile(this)">

                <!-- Preview Cadastro -->
                <div class="preview-area" id="cadastroPreview">
                    <h4>🔍 Análise do Arquivo de Cadastro</h4>
                    <p>Arquivo: <strong id="cadastroFileName">cadastros_agosto.xlsx</strong></p>
                    <div class="preview-stats">
                        <div class="preview-stat">
                            <div>👥 Novos</div>
                            <div style="color: #28a745;">156</div>
                        </div>
                        <div class="preview-stat">
                            <div>🔄 Atualizações</div>
                            <div style="color: #ffc107;">23</div>
                        </div>
                        <div class="preview-stat">
                            <div>⚠️ Duplicados</div>
                            <div style="color: #dc3545;">7</div>
                        </div>
                        <div class="preview-stat">
                            <div>✅ Válidos</div>
                            <div style="color: #17a2b8;">172</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="processCadastro()">🚀 Importar Cadastro</button>
                </div>

                <!-- Ações -->
                <div style="margin-top: 15px;">
                    <button class="btn" onclick="openCadastroHistory()">📋 Histórico</button>
                    <button class="btn secondary" onclick="validateCadastro()">✅ Validar</button>
                    <button class="btn secondary" onclick="exportCadastro()">💾 Exportar</button>
                </div>

                <!-- Mini Chart -->
                <div style="margin-top: 15px;">
                    <h5>📈 Evolução de Cadastros</h5>
                    <div class="mini-chart">
                        <div class="chart-bar" style="height: 40%;"></div>
                        <div class="chart-bar" style="height: 60%;"></div>
                        <div class="chart-bar" style="height: 80%;"></div>
                        <div class="chart-bar" style="height: 90%;"></div>
                        <div class="chart-bar" style="height: 100%;"></div>
                        <div class="chart-bar" style="height: 75%;"></div>
                    </div>
                </div>
            </div>

            <!-- 2. IMPORTAR/ATUALIZAR MOVIMENTO -->
            <div class="box fade-in">
                <h2>🏆 Importar/Atualizar Movimento de Clientes</h2>
                
                <!-- Status do Movimento -->
                <div class="status-card info">
                    <h4>📊 Status dos Movimentos</h4>
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="label">📅 Última Importação</div>
                            <div class="value" id="lastMovimentoDate">15/08/2025</div>
                        </div>
                        <div class="status-item">
                            <div class="label">📊 Movimentos</div>
                            <div class="value" id="totalMovimentosCount">2.856</div>
                        </div>
                        <div class="status-item">
                            <div class="label">⏱️ Há quanto tempo</div>
                            <div class="value" id="movimentoTimeSince">3 dias</div>
                        </div>
                    </div>
                    
                    <div class="alert success">
                        <span>✅</span>
                        <span>Movimentos atualizados recentemente!</span>
                    </div>
                </div>

                <!-- Upload de Movimento -->
                <div class="upload-area" id="movimentoUpload" onclick="document.getElementById('fileMovimento').click()">
                    <div style="font-size: 2em; margin-bottom: 10px;">🏆</div>
                    <div><strong>Clique ou arraste planilha de movimentos</strong></div>
                    <div style="font-size: 0.8em; opacity: 0.7;">Excel com dados de atendimentos</div>
                </div>
                <input type="file" id="fileMovimento" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleMovimentoFile(this)">

                <!-- Preview Movimento -->
                <div class="preview-area" id="movimentoPreview">
                    <h4>🔍 Análise dos Movimentos</h4>
                    <p>Arquivo: <strong id="movimentoFileName">movimentos_agosto.xlsx</strong></p>
                    <div class="preview-stats">
                        <div class="preview-stat">
                            <div>📈 Novos</div>
                            <div style="color: #28a745;">89</div>
                        </div>
                        <div class="preview-stat">
                            <div>🔄 Atualizações</div>
                            <div style="color: #ffc107;">12</div>
                        </div>
                        <div class="preview-stat">
                            <div>💰 Receita</div>
                            <div style="color: #17a2b8;">R$ 4.5k</div>
                        </div>
                        <div class="preview-stat">
                            <div>✅ Válidos</div>
                            <div style="color: #20c997;">98</div>
                        </div>
                    </div>
                    <button class="btn success" onclick="processMovimento()">🚀 Importar Movimentos</button>
                </div>

                <!-- Ações -->
                <div style="margin-top: 15px;">
                    <button class="btn" onclick="openMovimentoHistory()">📋 Histórico</button>
                    <button class="btn secondary" onclick="generateReport()">📊 Relatório</button>
                    <button class="btn secondary" onclick="exportMovimento()">💾 Backup</button>
                </div>

                <!-- Mini Chart -->
                <div style="margin-top: 15px;">
                    <h5>📈 Movimento Semanal</h5>
                    <div class="mini-chart">
                        <div class="chart-bar" style="height: 70%;"></div>
                        <div class="chart-bar" style="height: 85%;"></div>
                        <div class="chart-bar" style="height: 95%;"></div>
                        <div class="chart-bar" style="height: 100%;"></div>
                        <div class="chart-bar" style="height: 80%;"></div>
                        <div class="chart-bar" style="height: 60%;"></div>
                        <div class="chart-bar" style="height: 90%;"></div>
                    </div>
                </div>
            </div>

            <!-- 3. ADICIONAR CLIENTE MANUALMENTE -->
            <div class="box fade-in">
                <h2>👤 Adicionar Cliente Manualmente</h2>
                
                <!-- Status Manual -->
                <div class="status-card warning">
                    <h4>📊 Cadastros Manuais Hoje</h4>
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="label">👥 Hoje</div>
                            <div class="value" id="cadastrosHojeCount">12</div>
                        </div>
                        <div class="status-item">
                            <div class="label">📅 Esta Semana</div>
                            <div class="value" id="cadastrosSemana">47</div>
                        </div>
                        <div class="status-item">
                            <div class="label">🏆 Este Mês</div>
                            <div class="value" id="cadastrosMes">156</div>
                        </div>
                    </div>
                    
                    <div class="alert info">
                        <span>💡</span>
                        <span>Meta diária: 15 cadastros (faltam 3)</span>
                    </div>
                </div>

                <!-- Formulário de Cadastro -->
                <form id="clienteForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>👤 Nome Completo</label>
                            <input type="text" id="nomeCliente" placeholder="Digite o nome completo" required>
                        </div>
                        <div class="form-group">
                            <label>📱 Telefone</label>
                            <input type="tel" id="telefoneCliente" placeholder="(11) 99999-9999" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>📧 Email</label>
                            <input type="email" id="emailCliente" placeholder="cliente@email.com">
                        </div>
                        <div class="form-group">
                            <label>🎂 Data de Nascimento</label>
                            <input type="date" id="nascimentoCliente">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>📍 Endereço</label>
                        <input type="text" id="enderecoCliente" placeholder="Rua, número, bairro">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label>✂️ Serviço Preferido</label>
                            <select id="servicoPreferido">
                                <option value="">Selecione...</option>
                                <option value="corte">Corte de Cabelo</option>
                                <option value="barba">Barba</option>
                                <option value="completo">Corte + Barba</option>
                                <option value="outros">Outros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>💰 Valor Usual</label>
                            <input type="number" id="valorUsual" placeholder="0.00" step="0.01">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>📝 Observações</label>
                        <textarea id="observacoes" rows="3" placeholder="Preferências, alergias, etc."></textarea>
                    </div>

                    <!-- Ações do Formulário -->
                    <div style="margin-top: 20px;">
                        <button type="button" class="btn success" onclick="saveCliente()">💾 Salvar Cliente</button>
                        <button type="button" class="btn secondary" onclick="clearForm()">🔄 Limpar</button>
                        <button type="button" class="btn" onclick="fillExample()">📝 Exemplo</button>
                    </div>
                </form>

                <!-- Success Message -->
                <div class="success-message" id="successMessage">
                    ✅ Cliente cadastrado com sucesso!
                </div>

                <!-- Quick Actions -->
                <div style="margin-top: 20px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 15px;">
                    <h5>🚀 Ações Rápidas</h5>
                    <button class="btn" onclick="openClientList()">👥 Ver Clientes</button>
                    <button class="btn secondary" onclick="exportClientes()">📊 Exportar Lista</button>
                    <button class="btn secondary" onclick="importContacts()">📲 Importar Contatos</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Universal -->
    <div id="universalModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent">
                <!-- Conteúdo será inserido dinamicamente -->
            </div>
        </div>
    </div>

    <script>
        // Dados simulados
        let systemData = {
            cadastros: {
                total: 1247,
                lastImport: new Date('2025-08-10T10:30:00'),
                newToday: 12
            },
            movimentos: {
                total: 2856,
                lastImport: new Date('2025-08-15T14:30:00'),
                revenue: 4500
            },
            manual: {
                today: 12,
                week: 47,
                month: 156,
                dailyGoal: 15
            }
        };

        // Atualizar tempos decorridos
        function updateTimeSince() {
            const now = new Date();
            
            // Cadastro
            const cadastroDiff = now - systemData.cadastros.lastImport;
            const cadastroDays = Math.floor(cadastroDiff / (1000 * 60 * 60 * 24));
            document.getElementById('cadastroTimeSince').textContent = `${cadastroDays} dias`;
            
            // Movimento
            const movimentoDiff = now - systemData.movimentos.lastImport;
            const movimentoDays = Math.floor(movimentoDiff / (1000 * 60 * 60 * 24));
            document.getElementById('movimentoTimeSince').textContent = `${movimentoDays} dias`;
        }

        // Handlers de arquivos
        function handleCadastroFile(input) {
            if (input.files.length > 0) {
                const file = input.files[0];
                document.getElementById('cadastroFileName').textContent = file.name;
                document.getElementById('cadastroPreview').style.display = 'block';
                showNotification(`📊 Arquivo "${file.name}" analisado!`, 'success');
            }
        }

        function handleMovimentoFile(input) {
            if (input.files.length > 0) {
                const file = input.files[0];
                document.getElementById('movimentoFileName').textContent = file.name;
                document.getElementById('movimentoPreview').style.display = 'block';
                showNotification(`🏆 Arquivo "${file.name}" analisado!`, 'success');
            }
        }

        // Processamento de arquivos
        function processCadastro() {
            showProgress('Processando cadastros...', () => {
                systemData.cadastros.total += 156;
                systemData.cadastros.lastImport = new Date();
                document.getElementById('totalRegistros').textContent = systemData.cadastros.total.toLocaleString();
                document.getElementById('totalCadastros').textContent = systemData.cadastros.total.toLocaleString();
                document.getElementById('lastCadastroDate').textContent = new Date().toLocaleDateString('pt-BR');
                document.getElementById('cadastroPreview').style.display = 'none';
                updateTimeSince();
                showNotification('✅ Cadastros importados com sucesso! 156 novos registros.', 'success');
            });
        }

        function processMovimento() {
            showProgress('Processando movimentos...', () => {
                systemData.movimentos.total += 89;
                systemData.movimentos.lastImport = new Date();
                document.getElementById('totalMovimentosCount').textContent = systemData.movimentos.total.toLocaleString();
                document.getElementById('totalMovimentos').textContent = systemData.movimentos.total.toLocaleString();
                document.getElementById('lastMovimentoDate').textContent = new Date().toLocaleDateString('pt-BR');
                document.getElementById('movimentoPreview').style.display = 'none';
                updateTimeSince();
                showNotification('🏆 Movimentos importados com sucesso! 89 novos registros.', 'success');
            });
        }

        // Cliente manual
        function saveCliente() {
            const form = document.getElementById('clienteForm');
            const nome = document.getElementById('nomeCliente').value;
            const telefone = document.getElementById('telefoneCliente').value;
            
            if (!nome || !telefone) {
                showNotification('⚠️ Preencha pelo menos nome e telefone!', 'warning');
                return;
            }

            // Simular salvamento
            showProgress('Salvando cliente...', () => {
                systemData.manual.today++;
                systemData.manual.week++;
                systemData.manual.month++;
                systemData.cadastros.total++;
                
                // Atualizar interface
                document.getElementById('cadastrosHojeCount').textContent = systemData.manual.today;
                document.getElementById('cadastrosSemana').textContent = systemData.manual.week;
                document.getElementById('cadastrosMes').textContent = systemData.manual.month;
                document.getElementById('cadastrosHoje').textContent = systemData.manual.today;
                document.getElementById('totalCadastros').textContent = systemData.cadastros.total.toLocaleString();
                
                // Limpar formulário
                form.reset();
                
                // Mostrar sucesso
                const successMsg = document.getElementById('successMessage');
                successMsg.style.display = 'block';
                setTimeout(() => {
                    successMsg.style.display = 'none';
                }, 3000);
                
                showNotification(`✅ Cliente "${nome}" cadastrado com sucesso!`, 'success');
                
                // Verificar meta
                const remaining = systemData.manual.dailyGoal - systemData.manual.today;
                if (remaining <= 0) {
                    showNotification('🎉 Meta diária atingida! Parabéns!', 'success');
                }
            });
        }

        function clearForm() {
            document.getElementById('clienteForm').reset();
            showNotification('🔄 Formulário limpo!', 'info');
        }

        function fillExample() {
            document.getElementById('nomeCliente').value = 'João Silva Santos';
            document.getElementById('telefoneCliente').value = '(11) 99999-9999';
            document.getElementById('emailCliente').value = 'joao.silva@email.com';
            document.getElementById('enderecoCliente').value = 'Rua das Flores, 123 - Centro';
            document.getElementById('servicoPreferido').value = 'completo';
            document.getElementById('valorUsual').value = '35.00';
            document.getElementById('observacoes').value = 'Cliente preferencial, gosta de conversar sobre futebol.';
            showNotification('📝 Exemplo preenchido!', 'info');
        }

        // Modais
        function openCadastroHistory() {
            const content = `
                <h2>📋 Histórico de Importações - Cadastros</h2>
                <div style="margin: 20px 0;">
                    <input type="text" placeholder="🔍 Buscar..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 10/08/2025 - 10:30</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 cadastros_agosto.xlsx | 👥 +156 novos | 🔄 23 atualizações | ✅ Sucesso</div>
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 03/08/2025 - 14:15</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 base_julho.csv | 👥 +89 novos | 🔄 12 atualizações | ✅ Sucesso</div>
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 28/07/2025 - 09:45</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 clientes_promocao.xlsx | 👥 +67 novos | 🔄 8 atualizações | ⚠️ 3 erros</div>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn secondary">📊 Exportar Relatório</button>
                    <button class="btn danger">🗑️ Limpar Histórico</button>
                </div>
            `;
            openModal(content);
        }

        function openMovimentoHistory() {
            const content = `
                <h2>📋 Histórico de Movimentos</h2>
                <div style="margin: 20px 0;">
                    <input type="text" placeholder="🔍 Buscar..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 15/08/2025 - 14:30</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 movimentos_agosto.xlsx | 🏆 +89 novos | 💰 R$ 4.500 | ✅ Sucesso</div>
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 12/08/2025 - 11:20</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 vendas_semana.csv | 🏆 +67 novos | 💰 R$ 3.200 | ✅ Sucesso</div>
                </div>
                <div class="history-item">
                    <div style="font-weight: bold; color: #ffd700;">📅 08/08/2025 - 16:15</div>
                    <div style="margin-top: 5px; opacity: 0.8;">📁 relatorio_julho.xlsx | 🏆 +124 novos | 💰 R$ 5.800 | ✅ Sucesso</div>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn secondary">📊 Gerar Relatório</button>
                    <button class="btn secondary">💾 Backup Completo</button>
                </div>
            `;
            openModal(content);
        }

        function openClientList() {
            const content = `
                <h2>👥 Lista de Clientes Recentes</h2>
                <div style="margin: 20px 0;">
                    <input type="text" placeholder="🔍 Buscar cliente..." style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc;">
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <div class="history-item">
                        <div style="font-weight: bold;">👤 João Silva Santos</div>
                        <div style="opacity: 0.8;">📱 (11) 99999-9999 | ✂️ Corte + Barba | 💰 R$ 35,00</div>
                    </div>
                    <div class="history-item">
                        <div style="font-weight: bold;">👤 Maria Oliveira</div>
                        <div style="opacity: 0.8;">📱 (11) 88888-8888 | ✂️ Corte | 💰 R$ 25,00</div>
                    </div>
                    <div class="history-item">
                        <div style="font-weight: bold;">👤 Carlos Mendes</div>
                        <div style="opacity: 0.8;">📱 (11) 77777-7777 | ✂️ Barba | 💰 R$ 15,00</div>
                    </div>
                    <div class="history-item">
                        <div style="font-weight: bold;">👤 Ana Costa</div>
                        <div style="opacity: 0.8;">📱 (11) 66666-6666 | ✂️ Completo | 💰 R$ 40,00</div>
                    </div>
                </div>
                <div style="margin-top: 20px; text-align: center;">
                    <button class="btn">📝 Novo Cliente</button>
                    <button class="btn secondary">📊 Exportar Lista</button>
                </div>
            `;
            openModal(content);
        }

        function openModal(content) {
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('universalModal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('universalModal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        // Utilitários
        function showProgress(message, callback) {
            showNotification(`⏳ ${message}`, 'info');
            setTimeout(callback, 2000);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `alert ${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '1001';
            notification.style.minWidth = '300px';
            notification.style.maxWidth = '400px';
            notification.innerHTML = `<span>${message}</span>`;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        // Funções de ação
        function validateCadastro() {
            showProgress('Validando dados...', () => {
                showNotification('✅ Cadastros validados! 1.247 registros íntegros.', 'success');
            });
        }

        function exportCadastro() {
            showProgress('Exportando cadastros...', () => {
                showNotification('💾 Arquivo exportado: cadastros_backup_' + new Date().toISOString().split('T')[0] + '.xlsx', 'success');
            });
        }

        function exportMovimento() {
            showProgress('Exportando movimentos...', () => {
                showNotification('💾 Arquivo exportado: movimentos_backup_' + new Date().toISOString().split('T')[0] + '.xlsx', 'success');
            });
        }

        function generateReport() {
            showProgress('Gerando relatório...', () => {
                showNotification('📊 Relatório gerado! Receita total: R$ 4.500,00 | Atendimentos: 89', 'success');
            });
        }

        function exportClientes() {
            showProgress('Exportando lista de clientes...', () => {
                showNotification('📊 Lista exportada: clientes_completa_' + new Date().toISOString().split('T')[0] + '.xlsx', 'success');
            });
        }

        function importContacts() {
            showNotification('📲 Funcionalidade em desenvolvimento! Em breve você poderá importar da agenda.', 'info');
        }

        // Drag and Drop
        function setupDragAndDrop() {
            const uploadAreas = ['cadastroUpload', 'movimentoUpload'];
            
            uploadAreas.forEach(areaId => {
                const area = document.getElementById(areaId);
                
                area.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    area.classList.add('dragover');
                });
                
                area.addEventListener('dragleave', () => {
                    area.classList.remove('dragover');
                });
                
                area.addEventListener('drop', (e) => {
                    e.preventDefault();
                    area.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const fileInput = areaId === 'cadastroUpload' ? 
                            document.getElementById('fileCadastro') : 
                            document.getElementById('fileMovimento');
                        
                        fileInput.files = files;
                        
                        if (areaId === 'cadastroUpload') {
                            handleCadastroFile(fileInput);
                        } else {
                            handleMovimentoFile(fileInput);
                        }
                    }
                });
            });
        }

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            updateTimeSince();
            setupDragAndDrop();
            
            // Atualizar a cada minuto
            setInterval(updateTimeSince, 60000);
            
            // Notificação de boas-vindas
            setTimeout(() => {
                showNotification('🎉 Sistema completo carregado! Todas as funcionalidades estão ativas.', 'success');
            }, 1000);
            
            // Simular atualização de dados em tempo real
            setInterval(() => {
                // Pequenas variações aleatórias nos números
                if (Math.random() > 0.7) {
                    systemData.manual.today += Math.floor(Math.random() * 2);
                    document.getElementById('cadastrosHojeCount').textContent = systemData.manual.today;
                    document.getElementById('cadastrosHoje').textContent = systemData.manual.today;
                }
            }, 30000);
        });

        // Fechar modal clicando fora
        window.onclick = function(event) {
            const modal = document.getElementById('universalModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Formatação de telefone automática
        document.getElementById('telefoneCliente').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length >= 11) {
                value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
            } else if (value.length >= 7) {
                value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
            } else if (value.length >= 3) {
                value = value.replace(/(\d{2})(\d{0,5})/, '($1) $2');
            }
            e.target.value = value;
        });

        // Validação de email
        document.getElementById('emailCliente').addEventListener('blur', function(e) {
            const email = e.target.value;
            if (email && !email.includes('@')) {
                showNotification('⚠️ Email inválido!', 'warning');
                e.target.focus();
            }
        });
    </script>
</body>
</html>